<p-card header="Editar carrusel de películas" class="mt-5 mb-5">

  <div class="container">

    <div class="row">
      <!-- Columna PickList -->
      <div class="col-12 col-md-12 mb-3">
        <p-pickList
          [source]="listMovies"
          [target]="listUpdates"
          [dragdrop]="true"
          [responsive]="true"
          [disabled]="loading"
          breakpoint="500px"
          (onMoveToTarget)="onMoveToTarget($event)"
          (onMoveToSource)="onMoveToSource($event)"
          (onTargetReorder)="upPositionPoster($event)"

        >
          <ng-template let-item pTemplate="item">
            <div
              class="item-container"
              [ngClass]="{ 'existing-item': existingIds.has(item.externalMovieId) }"
            >
              <p>{{ item.title_snapshoot }}</p>
              <i
                *ngIf="existingIds.has(item.externalMovieId)"
                class="pi pi-exclamation-circle"
                title="Ya existe en el carrusel"
              ></i>
            </div>
          </ng-template>
        </p-pickList>
      </div>

    </div>

  </div>
</p-card>
<hr>
<p-card header="Editar carrusel de películas" class="mt-5 mb-5">
  <div class="container">
    <div class="row">

      <div class="col-12 col-md-12">

        @for(movie of listUpdates; track movie){
          <div style="border: 1px solid black;">
            <p-card [style]="{ overflow: 'hidden' }">

              <ng-template #header>
                <img [src]= movie.poster_url
                width="100%"
                height="150px"
                style="background-size: cover;"
                (click)="showDialog(movie)"
                >
              </ng-template>
              <ng-template #title>
                {{ movie.title_snapshoot }}
              </ng-template>

            </p-card>

          </div>
          <hr>
        }

      </div>
    </div>
  </div>
</p-card>

<p-dialog header="Editar imagen" [modal]="true" [(visible)]="visible" [style]="{ width: '40rem' }">

  <span class="p-text-secondary block mb-8">Actualizar la imagen con una URL</span>
  <hr>
  <form [formGroup]="editForm" (ngSubmit)="onChangesInput()">
    <div class="flex items-center gap-4 mb-4">
      <input pInputText id="posterUrl" class="flex-auto w-100" autocomplete="off" [value]="movieCarrusel?.poster_url" formControlName="posterUrl"/>
    </div>

    <div class="flex justify-end gap-2">
      <p-button type="button" (click)="closeDialog()" label="Cancelar" severity="secondary" (click)="visible = false" />
      <p-button (click)="onChangesInput()" type="submit" label="Actualizar" (click)="visible = false" />
    </div>
  </form>

</p-dialog>

<p-toast></p-toast>
<p-progressSpinner *ngIf="loading"></p-progressSpinner>
